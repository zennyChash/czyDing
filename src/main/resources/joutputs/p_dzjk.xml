<?xml version="1.0" encoding="UTF-8"?>
<pages>
	<joutput id="dzjk_df_nyr" name="最大日期" description=""> 
		<jTemplate>
		<![CDATA[
			{
			#if($dzjk_maxnyr&&$dzjk_maxnyr.rows.size()>0)
				"latestValidMonth":"$!{dzjk_maxnyr.rows[0].nyr}",
				"format":"Ymd" 
			#end
			}
		]]>
		</jTemplate>
		<vDs name="dzjk_maxnyr" refDtSrc="dzjk_maxnyr" fields="nyr"/>
	</joutput>
	<joutput id="dzjk_year" name="有数据的年" description=""> 
		<jTemplate>
		<![CDATA[
			{
			#if($dzjk_year&&$dzjk_year.rows.size()>0)
				"options":[
					#foreach($row in $dzjk_year.rows)
	   						{"bm":"$!{row.nian}","name":"$!{row.nian}"}#if($velocityCount != $dzjk_year.rows.size()),#end
	   					#end
				],
				"defaultOp":"$!{dzjk_year.rows[0].nian}"
			#end	
			}
		]]>
		</jTemplate>
		<vDs name="dzjk_year" refDtSrc="dzjk_year" fields="nian">
			<orderBy name = "nian" dir="desc"/>
		</vDs>
	</joutput>
	<joutput id="dzjk_month" name="有数据的月份选项" description=""> 
		<jTemplate>
		<![CDATA[
			{
			#if($dzjk_month&&$dzjk_month.rows.size()>0)
				"options":[
					#foreach($row in $dzjk_month.rows)
	   						{"bm":"$!{row.yue}","name":"$!{row.yue}"}#if($velocityCount != $dzjk_month.rows.size()),#end
	   					#end
				],
				"defaultOp":"$!{dzjk_month.rows[0].yue}"
			#end
			}
		]]>
		</jTemplate>
		<vDs name="dzjk_month" refDtSrc="dzjk_month" fields="ny,yue">
			<filter name = "nian" refParam="year" value="2018"/>
			<orderBy name = "ny" dir="desc"/>
		</vDs>
	</joutput>
	<joutput id="dzjk_day" name="有数据的日" description=""> 
		<jTemplate>
		<![CDATA[
			{
			#if($dzjk_day&&$dzjk_day.rows.size()>0)
				"options":[
					#foreach($row in $dzjk_day.rows)
	   						{"bm":"$!{row.ri}","name":"$!{row.ri}"}#if($velocityCount != $dzjk_day.rows.size()),#end
	   					#end
				],
				"defaultOp":"$!{dzjk_day.rows[0].ri}"
			#end
			}
		]]>
		</jTemplate>
		<vDs name="dzjk_day" refDtSrc="dzjk_day" fields="nyr,ri">
			<filter name = "ny" refParam="yearMonth" value="201804"/>
			<orderBy name = "ri" dir="desc"/>
		</vDs>
	</joutput>
	<joutput id="dzjk_srjd" name="电子金库-收入进度"  description=""> 
		<jTemplate>
		<![CDATA[
			{
			#if($dzjk_srjd&&$dzjk_srjd.rows.size()>0)
				"nlj_jk":"$!{dzjk_srjd.rows[0].nlj_jk}",
				"wcjd":"$!{dzjk_srjd.rows[0].wcjd}",
				"nlj_type":[
					#if($dzjk_srzb_jg&&$dzjk_srzb_jg.rows.size()>0)
					#foreach($row in $dzjk_srzb_jg.rows)
	   					{"name":"$!{row.jg}","value":"$!{row.nlj}","color":"$!{row.chartcolor}","selected":$!{row.selected}}
	   					#if($velocityCount != $dzjk_srzb_jg.rows.size()),#end
	   				#end
	   				#end
				],
				"srtb_line":[
					#if($dzjkYear&&$dzjkYear.rows.size()>0)
						{"name":"$!{thisYear}","data":[
							#foreach($foo in [1..12])
								#foreach($row in $dzjkYear.rows)
									#if($!{row.dyue}==$foo)
										#set($val = $!{row.nlj})
										#break; 
									#else 
										#set($val=0) 
									#end 
								#end 
								$val #if($foo<12),#end 
							#end 
						]},
					#else
						{"name":"$!{thisYear}","data":[]},
					#end		
					#if($dzjkLastYear&&$dzjkLastYear.rows.size()>0)
						{"name":"$!{lastYear}","data":[	
							#foreach($foo in [1..12])
								#foreach($row in $dzjkLastYear.rows)
									#if($!{row.dyue}==$foo)
										#set($val = $!{row.nlj}) 
										#break;
									#else 
										#set($val=0) 
									#end 
								#end 
								$val #if($foo<12),#end 
							#end 
						]}
	   				#else
						{"name":"$!{lastYear}","data":[]},
					#end
	   			]
			#else
				"nlj_jk":"",
				"wcjd":"",
				"nlj_type":[],
				"srtb_line":[]
			#end
			}
		]]>
		</jTemplate>
		<!-- 筛选字段的name，和数据源中的field一致，筛选值则使用请求中传递过来的值，refParam是其对应的请求参数名。
		如果不设置refParam，就从请求中查找“参数名=filter的name”的参数值。
		如果请求中未获得参数值，则用设计文件中的静态值，即filter中的value属性值；
		排序字段也类似。-->
		<vDs name="dzjk_srjd" refDtSrc="dzjk_srjd" fields="nlj_jk,wcjd">
			<filter name = "zwrq" value="20180430"/>
		</vDs>
		<vDs name="dzjk_srzb_jg" refDtSrc="dzjk_srzb_jg" fields="zwrq,jgdm_jk,jg,nlj,chartcolor,selected">
			<filter name = "zwrq" value="20180430"/>
		</vDs>
		<vDs name="dzjkYear" refDtSrc="dzjk_by_years" fields="nian,dyue,nlj">
			<filter name = "nian" refParam = "thisYear" value="2018"/>
			<orderBy name = "dyue" dir="asc"/>
		</vDs>
		<vDs name="dzjkLastYear" refDtSrc="dzjk_by_years" fields="nian,dyue,nlj">
			<filter name = "nian" refParam = "lastYear" value="2017"/>
			<orderBy name = "dyue" dir="asc"/>
		</vDs>
	</joutput>
	<joutput id="dzjk_fsz" name="金库-分税种"  description=""> 
		<jTemplate>
		<![CDATA[
			{
				"chartInfo":[
				#if($dzjk_fsz&&$dzjk_fsz.rows.size()>0)
					#foreach($row in $dzjk_fsz.rows)
		   				{"name":"$!{row.sz}","value":"$!{row.bnlj}"}#if($velocityCount != $dzjk_day.rows.size()),#end
		   			#end
		   		#end
				],
				"listInfo":[
				#if($dzjk_fsz&&$dzjk_fsz.rows.size()>0)
					#foreach($row in $dzjk_fsz.rows)
		   				{"szbm":"$!{row.szbm}","sz":"$!{row.sz}","bnlj":"$!{row.bnlj}",
		   				"sntq":"$!{row.sntq}","tbzz":"$!{row.tbzz}","srzb":"$!{row.srzb}","class":"tax_$!{row.szbm}"
		   				}#if($velocityCount != $dzjk_day.rows.size()),#end
		   			#end
		   		#end
				]
			}
		]]>
		</jTemplate>
		<!-- 筛选字段的name，和数据源中的field一致，筛选值则使用请求中传递过来的值，refParam是其对应的请求参数名。
		如果不设置refParam，就从请求中查找“参数名=filter的name”的参数值。
		如果请求中未获得参数值，则用设计文件中的静态值，即filter中的value属性值；
		排序字段也类似。-->
		<vDs name="dzjk_fsz" fields="zwrq,szbm,sz,bnlj,sntq,tbzz,srzb">
			<filter name = "zwrq" value="20180430"/>
			<orderBy name = "szbm" />
		</vDs>
	</joutput>
</pages>

