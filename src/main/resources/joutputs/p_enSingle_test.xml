<?xml version="1.0" encoding="UTF-8"?>
<pages>
	<joutput id="dhcx_df_ny" name="单户查询-最大月份" description=""> 
		<jTemplate>
		<![CDATA[
			{
			#if($en_maxny&&$en_maxny.rows.size()>0)
				"latestValidMonth":"$!{en_maxny.rows[0].ny}",
				"format":"Ym" 
			#end	
			}
		]]>
		</jTemplate>
		<vDs name="en_maxny" refDtSrc="en_maxny" fields="ny">
			<filter name = "swdjzh" value="91330604146165334B"/>
		</vDs>
	</joutput>
	<joutput id="dhcx_year" name="单户查询-有数据的年" description=""> 
		<jTemplate>
		<![CDATA[
			{
				#if($dhcx_year&&$dhcx_year.rows.size()>0)
				"options":[
					#foreach($row in $dhcx_year.rows)
	   					{"bm":"$!{row.nian}","name":"$!{row.nian}"}#if($velocityCount != $dhcx_year.rows.size()),#end
	   				#end
				],
				"defaultOp":"$!{dhcx_year.rows[0].nian}"
				#end
			}
		]]>
		</jTemplate>
		<vDs name="dhcx_year" refDtSrc="en_year" fields="nian">
			<filter name = "swdjzh" value="91330604146165334B"/>
			<orderBy name = "nian" dir="desc"/>
		</vDs>
	</joutput>
	<joutput id="dhcx_month" name="单户查询-有数据的月份选项" description=""> 
		<jTemplate>
		<![CDATA[
			{
			#if($en_month&&$en_month.rows.size()>0)
				"options":[
					#foreach($row in $en_month.rows)
	   						{"bm":"$!{row.yue}","name":"$!{row.yue}"}#if($velocityCount != $en_month.rows.size()),#end
	   					#end
				],
				"defaultOp":"$!{en_month.rows[0].yue}"
			#end
			}
		]]>
		</jTemplate>
		<vDs name="en_month" refDtSrc="en_month" fields="ny,yue">
			<filter name = "swdjzh" value="91330604146165334B"/>
			<filter name = "nian" refParam="year" value="2018"/>
			<orderBy name = "yue" dir="desc"/>
		</vDs>
	</joutput>
<!-- 	<joutput id="ens_test" name="企业" description="">  -->
<!-- 		<jTemplate> -->
<!-- 		<![CDATA[ -->
<!-- 			{ -->
<!-- 				"options":[ -->
<!-- 					#foreach($row in $en_test.rows) -->
<!-- 	   						{"bm":"$!{row.pyorder}","name":"$!{row.mc}"}#if($velocityCount != $en_rq.rows.size()),#end -->
<!-- 	   					#end -->
<!-- 				], -->
<!-- 				"defaultOp":"$!{en_rq.rows[0].mc}" -->
<!-- 			} -->
<!-- 		]]> -->
<!-- 		</jTemplate> -->
<!-- 		<vDs name="en_test" refDtSrc="enbasic" fields="swdjzh,mc,pyorder" paging="true" > -->
<!-- 			<filter name = "pyorder" dataType="integer" ftype="range" value="[1,)"/> -->
<!-- 			<orderBy name = "pyorder" dataType="integer" dir="asc"/> -->
<!-- 		</vDs> -->
<!-- 	</joutput> -->
	<joutput id="dhcx_basic" name="单户查询——企业信息"  description=""> 
		<jTemplate>
		<![CDATA[
			{
				#if($dhcx_basic&&$dhcx_basic.rows.size()>0)
					"swdjzh":"$!{dhcx_basic.rows[0].swdjzh}",
					"mc":"$!{dhcx_basic.rows[0].mc}",
					"czfp":"$!{dhcx_basic.rows[0].czfp}",
					"dz":"$!{dhcx_basic.rows[0].dz}",
					"hy":"$!{dhcx_basic.rows[0].hy}",
					"ssgx":"5012",
				#end
			}
		]]>
		</jTemplate>
		<!-- 筛选字段的name，和数据源中的field一致，筛选值则使用请求中传递过来的值，refParam是其对应的请求参数名。
		如果不设置refParam，就从请求中查找“参数名=filter的name”的参数值。
		如果请求中未获得参数值，则用设计文件中的静态值，即filter中的value属性值；
		排序字段也类似。-->
		<vDs name="dhcx_basic" refDtSrc="enbasic" fields="swdjzh,mc,czfp,fddbr,dz,hy">
			<filter name = "swdjzh" value="91330604146165334B"/>
		</vDs>
	</joutput>
	<joutput id="dhcx_tax" name="单户查询——企业税收信息"  description=""> 
		<jTemplate>
		<![CDATA[
			{
			#if($en_tax&&$en_tax.rows.size()>0)
				#set( $qnlj = $!{en_tax.rows[0].sn_zse} * 0.8 )
				"swdjzh":"$!{en_tax.rows[0].swdjzh}",
				"mc":"$!{en_tax.rows[0].mc}",
				"czfp":"$!{en_tax.rows[0].czfp}",
				"bnlj":"$!{en_tax.rows[0].bn_zse}",
				"snlj":"$!{en_tax.rows[0].sn_zse}",
				"qnlj":"$!{qnlj}"
			#end
			}
		]]>
		</jTemplate>
		<!-- 筛选字段的name，和数据源中的field一致，筛选值则使用请求中传递过来的值，refParam是其对应的请求参数名。
		如果不设置refParam，就从请求中查找“参数名=filter的name”的参数值。
		如果请求中未获得参数值，则用设计文件中的静态值，即filter中的value属性值；
		排序字段也类似。-->
		<vDs name="en_tax" fields="swdjzh,mc,czfp,bn_zse,sn_zse,tbzz,bn_zz,bn_ygz,bn_qysd,bn_grsd,bn_cswhjs,bn_yh">
			<filter name = "swdjzh" value="91330604146165334B"/>
			<filter name = "ny" value="201805"/>
		</vDs>
	</joutput>
	<joutput id="dhcx_basic_more" name="单户查询——企业税收信息"  description=""> 
		<jTemplate>
		<![CDATA[
			{
				fields:[{
					"fieldName":"swdjzh",
					"value":"$!{dhcx_basic.rows[0].swdjzh}",
					"fieldLabel":"社会信用代码"
				},{
					"fieldName":"kyrq",
					"value":"$!{dhcx_basic.rows[0].kyrq}",
					"fieldLabel":"开业日期"
				},{
					"fieldName":"fddbr",
					"value": "$!{dhcx_basic.rows[0].fddbr}",
					"fieldLabel":"法定代表人"
				},{
					"fieldName":"qyzt",
					"value": "$!{dhcx_basic.rows[0].qyzt}",
					"fieldLabel" :"企业状态"
				}]
			}
		]]>
		</jTemplate>
		<vDs name="dhcx_basic" refDtSrc="enbasic" fields="swdjzh,kyrq,fddbr,qyzt">
			<filter name = "swdjzh" value="91330604146165334B"/>
		</vDs>
	</joutput>
</pages>

