<?xml version="1.0" encoding="UTF-8"?>
<dataSource>
	<src id="buildingbasic" name="楼宇基本情况" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select a.*,rownum pyorder from(select bid,mc,dz,x,y from CZY_LYSS_LYLB
			order by NLSSORT(mc,'NLS_SORT=SCHINESE_PINYIN_M'))a
		]]>
		</sql>
		<cols>
			<col name="bid" canOrder="1" isFilter="1"/>
			<col name="mc" isFilter="1"/>
			<col name="pyorder" fldType="integer" canOrder="1" />
		</cols>
	</src>
	<src id="bd_maxny" name="最大有效月份" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select max(ny)ny,bid from CZY_LYSS_LYQYSS group by bid
		]]>
		</sql>
		<cols>
			<col name="bid" isFilter="1"/>
		</cols>
	</src>
	<src id="bd_year" name="楼宇有数据的年份" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select distinct substr(ny,1,4)nian,bid from  CZY_LYSS_LYQYSS
		]]>
		</sql>
		<cols>
			<col name="bid" isFilter="1"/>
			<col name="nian" canOrder="1"/>
		</cols>
	</src>
	<src id="bd_month" name="有数据的月份" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select distinct substr(ny,1,4)nian,substr(ny,5,2)yue,bid from CZY_LYSS_LYQYSS order by nian,yue
		]]>
		</sql>
		<cols>
			<col name="bid" isFilter="1"/>
			<col name="nian" isFilter="1"/>
			<col name="yue" canOrder="1"/>
		</cols>
	</src>
	<src id="bd_one" name="单个楼宇信息" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select ny,bid,lymc,dz,count(*) ecount,sum(bnlj) bnlj,sum(snlj) sntq from CZY_LYSS_LYQYSS
            group by ny,bid,lymc,dz
		]]>
		</sql>
		<cols>
			<col name="bid" canOrder="1" isFilter="1"/>
			<col name="ny" canOrder="1" isFilter="1"/>
			<col name="ecount" fldType="integer"/>
			<col name="bnlj" fldType="double"/>
			<col name="sntq" fldType="double"/>
		</cols>
	</src>
	<src id="bd_ens" name="楼宇入驻企业信息" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select ny,bid,lymc,swdjzh,mc,czfpbm,czfp,bnlj,snlj sntq,rank()over(partition by ny,bid order by bnlj desc) pm from CZY_LYSS_LYQYSS
		]]>
		</sql>
		<cols>
			<col name="bid" canOrder="1" isFilter="1"/>
			<col name="ny" canOrder="1" isFilter="1"/>
			<col name="swdjzh" isFilter="1"/>
			<col name="bnlj" fldType="double" />
			<col name="sntq" fldType="double"/>
			<col name="pm" fldType="integer" canOrder="1" />
		</cols>
	</src>
</dataSource>

