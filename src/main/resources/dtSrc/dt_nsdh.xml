<?xml version="1.0" encoding="UTF-8"?>
<dataSource>
	<src id="nsdh_maxny" name="最大有效月份" description="" sourceType ="sql">
		<sql>
		<![CDATA[
		select max(ny)ny from nsdh
		]]>
		</sql>
		<cols>
			<col name="ny" isFilter="1"/>
		</cols>
	</src>
	<src id="nsdh_year" name=" 有数据的年份" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select distinct substr(ny,1,4)nian from nsdh 
		]]>
		</sql>
		<cols>
			<col name="nian" canOrder="1"/>
		</cols>
	</src>
	<src id="nsdh_month" name="有数据的月份" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select distinct substr(ny,1,4)nian,substr(ny,5,2)yue,ny from nsdh 
		]]>
		</sql>
		<cols>
			<col name="nian" isFilter="1"/>
			<col name="yue" isFilter="1"/>
			<col name="ny" canOrder="1"/>
		</cols>
	</src>
	<src id="nsdh_basic" name="纳税大户概况" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select a.*,round(bnlj/sum(bnlj) over (partition by ny)*100,2) sszb_t from(
			select ny,tlimit,count(swdjzh)total,sum(bnlj)bnlj,sum(sntq)sntq,round((sum(bnlj)-sum(sntq))*100/sum(sntq),2)tbzz
			 from nsdh
			group by ny,tlimit)a
		]]>
		</sql>
		<cols>
			<col name="ny" canOrder="1" isFilter="1"/>
			<col name="tlimit" canOrder="1" isFilter="1"/>
			<col name="total" fldType="integer"/>
			<col name="bnlj" fldType="double"/>
			<col name="sntq" fldType="double" />
			<col name="tbzz" fldType="double" />
			<col name="sszb_t" fldType="double" />
		</cols>
	</src>
	<src id="nsdh_details" name="企业税收" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select ny,tlimit,swdjzh,mc,bnlj,sntq,decode(sntq,0,0,round((bnlj-sntq)*100/sntq,2))tbzz,
			round(bnlj/sum(bnlj) over (partition by ny)*100,2) sszb_t
			 from nsdh order by ny,tlimit desc,bnlj desc
		]]>
		</sql>
		<cols>
			<col name="ny" canOrder="1" isFilter="1"/>
			<col name="tlimit" canOrder="1" isFilter="1"/>
			<col name="swdjzh" isFilter="1"/>
			<col name="bnlj" fldType="double" canOrder="1"/>
			<col name="sntq" fldType="double" />
			<col name="tbzz" fldType="double" />
			<col name="sszb_t" fldType="double" />
		</cols>
	</src>
</dataSource>

