<?xml version="1.0" encoding="UTF-8"?>
<dataSource>
	<src id="dzjk_maxnyr" name="最大有效日期" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select max(zwrq_jk) nyr from YSSR_INDEX
		]]>
		</sql>
		<cols>
			<col name="nyr" canOrder="1"/>
		</cols>
	</src>
	<src id="dzjk_year" name="有数据的年份" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select distinct substr(zwrq_jk,1,4) nian from YSSR_INDEX
		]]>
		</sql>
		<cols>
			<col name="nian" canOrder="1"/>
		</cols>
	</src>
	<src id="dzjk_month" name="有数据的月份" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select distinct substr(zwrq_jk,1,4) nian,substr(zwrq_jk,5,2) yue,substr(zwrq_jk,1,6) ny from YSSR_INDEX
		]]>
		</sql>
		<cols>
			<col name="nian" isFilter="1"/>
			<col name="yue" isFilter="1"/>
			<col name="ny" canOrder="1"/>
		</cols>
	</src>
	<src id="dzjk_day" name="有数据的日期" description="" sourceType ="sql">
		<sql>
		<![CDATA[
			select distinct substr(zwrq_jk,1,6) ny,substr(zwrq_jk,7,2) ri from YSSR_INDEX
		]]>
		</sql>
		<cols>
			<col name="ny" isFilter="1"/>
			<col name="ri" isFilter="1"/>
		</cols>
	</src>
	<src id="dzjk_srjd" name="收入进度信息" description="" sourceType ="sql">
		<sql>
		<![CDATA[
with t as
(
SELECT zwrq_jk,'YBGGYSSR' kj,sum(ssdf+sbjjdf) se FROM czy_yssr
group by zwrq_jk
union all
SELECT zwrq_jk,'CZZSR' kj,sum(ssqb+sbjjdf) se FROM czy_yssr
group by zwrq_jk
)
select t.zwrq_jk,t.kj,t.se bnlj,s.se sntq,tb.yss,round(t.se/yss*100) wcbl,decode(s.se,0,0,round((t.se-s.se)/s.se*100,2)) tbzf
from t,t s,czy_yssr_zwrq_sntq rq,czy_yssr_tb tb
where t.zwrq_jk=rq.zwrq_bn and s.zwrq_jk=rq.zwrq_sn and t.kj=s.kj and substr(t.zwrq_jk,1,4)=tb.nian and t.kj=tb.kj
		]]>
		</sql>
		<cols>
			<col name="zwrq_jk" canOrder="1" isFilter="1"/>
			<col name="kj" isFilter="1" canOrder="1"/>
			<col name="bnlj" fldType="double" />
			<col name="sntq" fldType="double" />
			<col name="yss" fldType="double" />
			<col name="wcbl" fldType="double" />
			<col name="tbzf" fldType="double" />
		</cols>
	</src>
	<src id="dzjk_by_years" name="分年度税收对比" description="" sourceType ="sql">
		<sql>
		<![CDATA[
SELECT * FROM czy_yssr_srqs
		]]>
		</sql>
		<cols>
			<col name="nian_parm" fldType="integer" isFilter="1"/>
			<col name="nian" fldType="integer" canOrder="1"/>
            <col name="kj" canOrder="1"/>
			<col name="yiyue" fldType="double"/>
			<col name="eryue" fldType="double"/>
			<col name="sayue" fldType="double"/>
			<col name="siyue" fldType="double"/>
			<col name="wuyue" fldType="double"/>
			<col name="liyue" fldType="double"/>
			<col name="qiyue" fldType="double"/>
			<col name="bayue" fldType="double"/>
			<col name="jiyue" fldType="double"/>
			<col name="shyue" fldType="double"/>
			<col name="syyue" fldType="double"/>
			<col name="seyue" fldType="double"/>
		</cols>
	</src>
	<src id="dzjk_fsz" name="分税种详情" description="" sourceType ="sql">
		<sql>
		<![CDATA[
with t
as
(
select ny,zwrq_jk,szbm,sz,se,round((se/sum(se)over(partition by zwrq_jk))*100,2) srzb
from
(
SELECT z.nian||z.yue ny,y.zwrq_jk,case when y.szbm not in ('10101','10104','10106','10109','10113') then '99999' else y.szbm end szbm,decode(szbm,'10101','增值税','10104','企业所得税','10106','个人所得税','10109','城建税','10113','土地增值税','其他税费') sz,
sum(ssdf+sbjjdf) se FROM czy_yssr y,CZY_YSSR_ZWRQ z
where y.zwrq_jk=z.zwrq_jk
group by z.nian||z.yue,y.zwrq_jk,case when y.szbm not in ('10101','10104','10106','10109','10113') then '99999' else y.szbm end,decode(szbm,'10101','增值税','10104','企业所得税','10106','个人所得税','10109','城建税','10113','土地增值税','其他税费')
)
union all
select '999999' ny,9999999 zwrq_jk,'10101' szbm,'增值税' sz,0 se,0 srzb from dual
union all
select '999999' ny,9999999 zwrq_jk,'10104' szbm,'企业所得税' sz,0 se,0 srzb from dual
union all
select '999999' ny,9999999 zwrq_jk,'10106' szbm,'个人所得税' sz,0 se,0 srzb from dual
union all
select '999999' ny,9999999 zwrq_jk,'10109' szbm,'城建税' sz,0 se,0 srzb from dual
union all
select '999999' ny,9999999 zwrq_jk,'10113' szbm,'土地增值税' sz,0 se,0 srzb from dual
union all
select '999999' ny,9999999 zwrq_jk,'99999' szbm,'其他税费' sz,0 se,0 srzb from dual
)
select t.ny,t.szbm,t.sz,t.se bnlj,s.se sntq,decode(s.se,0,0,round((t.se-s.se)/s.se*100,2)) tbzf,t.srzb,r.color
from t,t s,czy_yssr_zwrq_sntq rq,RENDERS r
where t.zwrq_jk=rq.zwrq_bn and s.zwrq_jk=rq.zwrq_sn and t.szbm=s.szbm and t.sz=s.sz and r.rptid='dzjk_fsz' and t.szbm=r.lid
		]]>
		</sql>
		<cols>
			<col name="ny" canOrder="1" isFilter="1"/>
			<col name="szbm" canOrder="1" />
			<col name="bnlj" fldType="double"/>
			<col name="sntq" fldType="double"/>
			<col name="tbzf" fldType="double"/>
			<col name="srzb" fldType="double"/>
		</cols>
	</src>
	
</dataSource>